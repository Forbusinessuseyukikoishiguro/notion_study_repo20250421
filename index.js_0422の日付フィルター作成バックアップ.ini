require('dotenv').config();
const axios = require('axios');

// Notion API設定
const NOTION_KEY = process.env.NOTION_KEY;
const NOTION_DATABASE_ID = process.env.NOTION_DATABASE_ID;
const NOTION_API_BASE = 'https://api.notion.com/v1';

// APIクライアント
const notion = axios.create({
  baseURL: NOTION_API_BASE,
  headers: {
    'Authorization': `Bearer ${NOTION_KEY}`,
    'Content-Type': 'application/json',
    'Notion-Version': '2022-06-28'
  }
});

// 新しいページを作成する関数
async function createPage() {
  try {
    console.log('ページ作成リクエストを送信中...');
    const response = await notion.post('/pages', {
      parent: {
        database_id: NOTION_DATABASE_ID, // データベースID
      },
      properties: {
        Name: {
          title: [
            {
              text: {
                content: 'テスト年月日時間(*^-^*)', // ページ名
              },
            },
          ],
        },
      },
    });

    console.log('ページが作成されました:', response.data);
  } catch (error) {
    console.error('ページ作成中にエラーが発生しました:');
    console.error('エラーメッセージ:', error.message);
    if (error.response) {
      console.error('API応答:', JSON.stringify(error.response.data, null, 2));
    }
  }
}

// 実行
createPage();